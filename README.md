# Проект -   «СберАвтоподписка»
## Описание проекта.

**«СберАвтоподписка»** — это сервис долгосрочной аренды автомобилей для физлиц. Продуктовая команда сервиса хочет понять, из каких источников к нам идёт самый полезный трафик,
какие авто пользуются наибольшим спросом, с каких устройств чаще всего заходят на сайт, какие действия
и формулировки вызывают наибольший отклик.

### Описание услуг
Клиент платит фиксированный ежемесячный платёж и получает в пользование машину на срок от шести месяцев до трёх лет.
Также в платёж включены:
- страхование (КАСКО, ОСАГО, ДСАГО);
- техническое обслуживание и ремонт;
- сезонная смена шин и их хранение;
- круглосуточная служба поддержки.
За дополнительную сумму можно приобрести услугу консьерж-сервиса —
доставку автомобиля до сервисного центра и обратно на техническое
обслуживание, сезонную замену шин, ремонт.
### О продукте

В каталоге сервиса представлены более 20 моделей в наличии. Также сервис практикует покупку машины под конкретного пользователя для тех,
кто готов взять автомобиль в подписку, но не нашёл на сайте интересующий вариант.
Чтобы оформить подписку, необходимо кликнуть по понравившемуся автомобилю и выбрать:
- срок аренды: от шести месяцев до трёх лет;
- пакет пробега: лимит по количеству пройденных километров.
После клика по кнопке «Оформить подписку» нужно оставить свои контактные данные.

На сайте пользователь совершает целевые действия. Например, нажимает кнопки типа «Оставить заявку», «Заказать звонок».

Или нецелевые действия, например, просмотр карточек авто или «блуждания» по основной странице и страницам с помощью.

Когда заявка оставлена, с пользователем связывается менеджер для подбора оптимального варианта подписки. Клиент предоставляет документы   и «СберАвтоподписка» проводит скоринг,
в результате чего принимает решение, готовы ли мы выдать клиенту автомобиль в подписку. После успешного скоринга подбор автомобиля продолжается, в том числе возможен вариант
покупки конкретного автомобиля специально под клиента. После оплаты счёта клиент получает автомобиль в подписку: его можно забрать   в Москве, а также возможна доставка
автомобиля в другие города России.

После оформления подписки пользователь взаимодействует   со «СберАвтоподпиской» по телефону и с помощью электронной почты. Ссылки на оплату услуги приходят по почте и SMS. 

### Описание данных

***Целевое действие*** — события типа «Оставить заявку» и «Заказать звонок» (ga_hits.event_action in ['sub_car_claim_click', 'sub_car_claim_submit_click', 'sub_open_dialog_click', 'sub_custom_question_submit_click', 'sub_call_number_click', 'sub_callback_submit_click', 'sub_submit_success', 'sub_car_request_submit_click']).

***CR (Conversion Rate)*** — показатель конверсии из визита (уникальный session_id) в любое целевое действие в рамках одного визита (в случае наличия >1 целевого действия — считать все как одно). 

***Органический трафик*** — все визиты с ga_sessions.utm_medium in ('organic', 'referral', '(none)').

***Платный трафик***  — весь неорганический трафик. 

***Информация про марку и модель авто*** —  содержится в ga_hits.hit_page_path. 

***Реклама*** в социальных сетях — все визиты с ga_sessions.utm_source in ('QxAxdyPLuQMEcrdZWdWb', 'MvfHsxITijuriZxsqZqt', 'ISrKoXQCxqqYvAZICvjs', 'IZEXUFLARCUMynmHNBGo', 'PlbkrSYoHuZBWfYjYnfw', 'gVRrcxiDQubJiljoTbGm').

`ga_hits.csv`                                                                         

| # | Column          |       Description                        |Dtype      | isna    |
|---|-----------------|------------------------------------------|-----------|---------|
| 0 |   session_id    | ID визита                                |  object   |0        |    
| 1 |   hit_date      | дата события                             |  object   |0        |
| 2 |   hit_time      | время события                            |  float64  |9160322  |
| 3 |   hit_number    | порядковый номер события в рамках сессии |  int64    |0        |
| 4 |   hit_type      | тип события                              |  object   |0        |
| 5 |   hit_referer   | источник события                         |  object   |6274804  |
| 6 |   hit_page_path | страница события                         |  object   |0        |
| 7 |   event_category| тип действия                             |  object   |0        |
| 8 |   event_action  | действие                                 |  object   |0        |
| 9 |   event_label   | тег действия                             |  object   |3760184  |
| 10|   event_value   | значение результата действия              |  float64  |15726470 |

`df_session`

|#    |Column                   | Description                      | Dtype  | isna    |
|-----|-------------------------|----------------------------------|--------|---------|
| 0   |session_id               | ID визита                        |object  |  0      |
| 1   |client_id                | ID посетителя                    |object  |0        |
| 2   |visit_date               | дата визита                      |object  |0        |
| 3   |visit_time               | время визита                     | object |0        |
| 4   |visit_number             | порядковый номер визита клиента  |int64   |0        |
| 5   |utm_source               | канал привлечения                |object  |97       |
| 6   |utm_medium               | тип привлечения                  |object  |0        |
| 7   |utm_campaign             | рекламная кампания               | object |219603   |
| 8   |utm_adcontent            | ссылка по которой осуществлен визит клиета                                 |object  |335615   |
| 9   |utm_keyword              | ключевое слово                   | object |1082061  |
| 10  |device_category          | тип устройства                   |object  |0        |
| 11  |device_os                | ОС устройства                    |  object|1070138  |
| 12  |device_brand             | марка устройства                 |  object|367178   |
| 13  |device_model             | модель устройства                | object |1843704  |
| 14  |device_screen_resolution | разрешение экрана                | object |0        |
| 15  |device_browser           | браузер                          | object |0        |
| 16  |geo_country              | страна                           |object  |0        |
| 17  |geo_city                 | город                            | object |0        |



## Использованные библиотеки

Pandas NumPy Feature-engine Matplotlib Seaborn  Lightgbm XGBoost Bayesian-optimization

## Выводы

Проведен анализ данных и также предобработка данных, в ходе которой добавленны новые признаки и кодированны категориальные признаки.

| Модель  | ROC-AUC  |
|---|---|
| LogisticRegression  |  0.666949 |
| LinearSVC  |  0.61839 |
|  MLPClassifier |  0.696518  |
| GaussianNB  | 0.645072  |
|  DecisionTreeClassifier |  0.522172 |
| RandomForestClassifier  | 0.618262  |
| HistGradientBoostingClassifier  | 0.706127  |
|  XGBClassifier |  0.710057 |
|  LGBMClassifier |  0.706464 |

Лучший результат продемонстрировали две модели градиентного бустинга  XGBClassifier и LGBMClassifier. 

Лучшей моделью является LightGBM по следующим причинам:

- Один из лучших показателей roc_auc;
- Быстрое обучение;
- Модель интерпретируема, то есть можно получить показатели выжности признаков;
- Можно предсказать вероятность класса
  
Оптимизация модели и конвейера по подготовке данных проводится с помощью байесовской оптимизации. При разных гиперпараметрах модель обучается на тренировачных данных, а оценивается на валидационных.

**ROC-AUC на тестовой выборки равен  - 0.715478** 

Так же результат исследования важности признаков показал, что больше всего на отклик клиента связан с датой посещения сервиса и близость проживания клиента к г. Москва.

